<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Alex Handley</title>
    <description></description>
    <link></link>
    <atom:link href="/feed.xml" rel="self" type="application/rss+xml" />
    
      <item>
        <title>Afternoon hacking with Phoenix</title>
        <description>&lt;p&gt;Over the past few months my little side projects haven&amp;#39;t made it off the starting blocs. They have all had the same downfall of trying to achieve too much.. make a React app using Phoenix as the backend but spend the whole time getting the build tool setup how you want it.&lt;/p&gt;

&lt;p&gt;So today instead I decided to keep it simple, create an app to track my climbing sessions. Currently I keep all of my notes in a book which is boring as there isn&amp;#39;t much you can do with the data.&lt;/p&gt;

&lt;p&gt;As well as keeping my tech aspirations low I think what also really helped was that I defined my goals at the start:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Quickly record training session.&lt;/li&gt;
&lt;li&gt;Mobile friendly.&lt;/li&gt;
&lt;li&gt;Make data available.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Here it is, the sign in button doesn&amp;#39;t toggle and it looks pretty crap but I created something usable in under 4 hours... most of that was rolling my own sign in logic :&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/post_images/training_app.png&quot; alt=&quot;Image of the logs index page&quot;&gt;&lt;/p&gt;

&lt;p&gt;My future goals are once I have recorded a few weeks of data I might compare the number of hours training against conditioning and stretching to see if patterns emerge with tweaks/injuries. I could also map it against personal bests to show the effects training had over time.&lt;/p&gt;

&lt;p&gt;Checkout the code &lt;a href=&quot;https://github.com/alex-handley/climbing_training_app&quot;&gt;here&lt;/a&gt;&lt;/p&gt;
</description>
        <pubDate>Mon, 04 Jul 2016 10:38:00 +0100</pubDate>
        <link>/03-quick-hack-with-phoenix/</link>
        <guid isPermaLink="true">/03-quick-hack-with-phoenix/</guid>
      </item>
    
      <item>
        <title>Project Method Statements</title>
        <description>&lt;p&gt;I have been at my current job for just over 6 months and in that time our team has doubled in size, with that comes all of the usual problems that occur when a company started 2 years ago and now has over 100 staff and 20 engineers.
The growth pain I am going to talk about is how we get code from our computers to the live site, in the past i&amp;#39;ve worked on projects where deploying was as easy as merging the branch and typing &lt;code&gt;git push heroku master&lt;/code&gt; or &lt;code&gt;cap deploy&lt;/code&gt; if you&amp;#39;re not funded :) and as complex as connecting to a VPN, pushing to a private Git server, emailing DevOps and waiting a few hours/days for your change to be deployed.&lt;/p&gt;

&lt;p&gt;Both of these approaches are still vunerable to downtime caused by forgetting to migrate the database, they don&amp;#39;t solve what happens when it fails? how do you rollback?
While I was thinking about this with our CTO a few weeks back it reminded me of a past project I worked on with an Asbestos removal company, the way they remove this extremely hazzardious material is so tightly regulated that they are required to send a document to UK government health and safety department about how they plan to do it.
This document is called a method statement, the same idea works for how we deploy our applications, there should be an agreed method for the safest way to deploy the application and how rollback when it goes wrong.&lt;/p&gt;

&lt;p&gt;By writing down our method statement and agreeing it with the whole team, it means the whole team is accountable when something goes wrong, this doesnt necessarily mean the person who made the mistake gets sacked, it is more about finding out why? was the person deploying in a rush at 6PM cause a feature was snuck in mid sprint.
Now the we have a process that the whole team buys into and is accountable for, the next step is making it easy to update and make the process visible to people reviewing the pull request and it just so happens you can now do this with Github with &lt;a href=&quot;https://github.com/blog/2111-issue-and-pull-request-templates&quot;&gt;Pull Request Templates&lt;/a&gt;.
What has been great so far is because the whole team including people not comfortable with the terminal can amend the process and submit a Pull Request using the GitHub Website.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/post_images/pull_request_template.png&quot; alt=&quot;example pull request template&quot;&gt;&lt;/p&gt;
</description>
        <pubDate>Mon, 22 Feb 2016 09:38:00 +0000</pubDate>
        <link>/project-method-statements/</link>
        <guid isPermaLink="true">/project-method-statements/</guid>
      </item>
    
      <item>
        <title>The story of Mandrillus sphinx who needed glasses</title>
        <description>&lt;p&gt;I recently joined the Happiness squad at LostMyName and after a few days I was alerted by our customer service team that some of our customers were not receiving emails.&lt;/p&gt;

&lt;h2&gt;The Problem&lt;/h2&gt;

&lt;p&gt;At first I thought it was just a case of emails going into junk because Mandrill was indicating that the email had been delivered but it quickly became apparent that email were not making it to customers.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/post_images/mandrill-delivered.png&quot; alt=&quot;Mandrill indicating delivered&quot;&gt;
&lt;br /&gt;
&lt;caption&gt;Mandrill indicating that the email was delivered successfully&lt;/caption&gt;&lt;/p&gt;

&lt;p&gt;My next step was to contact Mandrill to see if they had any suggestions, their response was that after they get a successful response from the email service provider there job is done.
Mandrill support suggested contacting the service provider, I wanted to try and avoid this as I knew from experience this would be a nightmare but at this point I had no other ideas so I emailed the spam email account.&lt;/p&gt;

&lt;p&gt;Almost immediately I got a reply from the mail server saying the mailbox was full and could not store the email. Told you so.&lt;/p&gt;

&lt;p&gt;At this point I was completely out of ideas. A colleague suggested that it could be the IP addresses used by Mandrill, I had considered this but had rejected because there were only a few hundred missing emails.&lt;/p&gt;

&lt;h2&gt;The Cause&lt;/h2&gt;

&lt;p&gt;I emailed Mandrill enquiring about the IP addresses and at this point they said that the IP&amp;#39;s were fine, the issue was the status code being sent back by the email provider:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/post_images/550-spam-detected.png&quot; alt=&quot;550 Spam Detected&quot;&gt;
&lt;caption&gt;Cheers Mandrill...&lt;/caption&gt;&lt;/p&gt;

&lt;p&gt;Mandrill admitted that the response wasn&amp;#39;t getting parsed correctly and because of this emails were incorrectly being shown as delivered.
Now I knew the issue the actual debugging could start, I looked at the email template and decided it was ether the images or the buttons (links inside tables).&lt;/p&gt;

&lt;p&gt;To test this I needed access to an email account on the domain which was hard because it was a French ISP who only gave out accounts to customers. I lucked out and one of the customer services staff dad had an email account and the patience to handle me hounding him.&lt;/p&gt;

&lt;p&gt;After trialling removing different elements I found it was the button. The next experiment was to see if sending test emails with a unstyled link and it worked!&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/post_images/spammy-email.png&quot; alt=&quot;Spam Button&quot;&gt;
&lt;caption&gt;The problem&lt;/caption&gt;&lt;/p&gt;

&lt;h2&gt;The Solution&lt;/h2&gt;

&lt;p&gt;The problem made perfect sense in hindsight if you read the Mailchimp guide (in references), this button breaks two rules:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Avoid bright red fonts or going crazy with colors.&lt;/li&gt;
&lt;li&gt;DONâ€™T YELL IN ALL CAPS.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;After changing the colour and removing the CAPS it worked perfectly!&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/post_images/fixed-button.png&quot; alt=&quot;Fixed button&quot;&gt;
&lt;caption&gt;The Fixed Button&lt;/caption&gt;&lt;/p&gt;

&lt;p&gt;Hope this helps someone.&lt;/p&gt;

&lt;h2&gt;References&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;http://templates.mailchimp.com/concepts/spam-filters/&lt;/li&gt;
&lt;/ul&gt;
</description>
        <pubDate>Thu, 17 Sep 2015 10:38:00 +0100</pubDate>
        <link>/story-of-mandrillus-sphinx-who-needed-glasses/</link>
        <guid isPermaLink="true">/story-of-mandrillus-sphinx-who-needed-glasses/</guid>
      </item>
    
      <item>
        <title>My first 3 hours on a project</title>
        <description>&lt;p&gt;I recently started a new full time job which is a little daunting, for the first time in a long while I am going to be owning this code not just for 3/6 months but for possibly years to come.
After cloning the codebase, here are some of the things I did:&lt;/p&gt;

&lt;h2&gt;Open up the ReadMe&lt;/h2&gt;

&lt;p&gt;The ReadMe should hopefully tell you everything from the purpose to its dependencies. Sometimes instead of this you find a description of the framework or just placeholders, after much practice I can now not go into full on judgemental mode (this has taken some practice).&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/post_images/rails_default_readme.png&quot; alt=&quot;Rails Readme&quot;&gt;
&lt;caption&gt;The worst case, a default Rails Readme&lt;/caption&gt;&lt;/p&gt;

&lt;h2&gt;Open the Gemfile&lt;/h2&gt;

&lt;p&gt;The Gemfile can act as a harder to read Readme when the Readme is missing. For example if you see the PG gem then it is very likely the project is using PostgreSQL for it&amp;#39;s database adapter. Hopefully the Gemfile will also contain version numbers as well so you know immediately if Rails is running an ancient vulnerable version.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/post_images/example_gemfile.png&quot; alt=&quot;Rails ERD&quot;&gt;
&lt;caption&gt;A great Gemfile apart from PG not having a version :)&lt;/caption&gt;&lt;/p&gt;

&lt;h2&gt;Get someone else to do the leg work&lt;/h2&gt;

&lt;p&gt;I wrote a &lt;a href=&quot;https://github.com/alex-handley/schoolmaster&quot;&gt;Gem&lt;/a&gt; a while back for the interns at my company, its purpose was to look for the obvious issues that lead to the code style type discussions in a Pull Request.
The gem runs the following tools:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Brakeman&lt;/li&gt;
&lt;li&gt;bundler-audit&lt;/li&gt;
&lt;li&gt;cane&lt;/li&gt;
&lt;li&gt;Rails Best practices&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;These tools can give you a rough idea of code quality and if there are any critical issues that need to be solved such as vulnerabilities in gems or SQL injection possibilities.
The warnings are really just a guide but can help you get a grasp of the project.&lt;/p&gt;

&lt;h2&gt;Look at the ERD Diagram&lt;/h2&gt;

&lt;p&gt;I don&amp;#39;t always do this but if I want to quickly work out how the database has been designed (or not designed) I install the &lt;a href=&quot;https://github.com/voormedia/rails-erd&quot; target=&quot;_blank&quot;&gt;Rails ERD&lt;/a&gt; gem which creates a PDF &lt;a href=&quot;https://en.wikipedia.org/wiki/Entity%E2%80%93relationship_model&quot;&gt;ERD diagram&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/post_images/rake_erd.png&quot; alt=&quot;Rails ERD&quot;&gt;
&lt;br /&gt;
&lt;caption&gt;PDF output from Rake ERD&lt;/caption&gt;&lt;/p&gt;

&lt;h2&gt;Take a look at the open Pull Requests&lt;/h2&gt;

&lt;p&gt;Looking at the open pull requests you can see what the team is working on and get a grasp on how
the teams works. For example:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;PR Labels&lt;/li&gt;
&lt;li&gt;Branch naming&lt;/li&gt;
&lt;li&gt;Do they use hound?&lt;/li&gt;
&lt;li&gt;Is there a CI?&lt;/li&gt;
&lt;/ul&gt;

&lt;h2&gt;Fix a bug&lt;/h2&gt;

&lt;p&gt;The last step is to dive in and try and fix something, when a new developer joins the team I normally try and ensure a minor issue/feature is on the board for them.
This gives the developer a chance to push, get green on CI, create a pull request and then deploy to staging/production.
I think this is the best first day a developer can have, it really breaks the ice and gets them off in the right direction, you can even pair on the bug :)&lt;/p&gt;

&lt;p&gt;Hopefully your team is mature enough to not troll the PR!&lt;/p&gt;
</description>
        <pubDate>Sat, 05 Sep 2015 10:38:00 +0100</pubDate>
        <link>/first-3-hours-on-project/</link>
        <guid isPermaLink="true">/first-3-hours-on-project/</guid>
      </item>
    
      <item>
        <title>One year as a Sport Climber - Part 1</title>
        <description>&lt;p&gt;This past year I have started Sport climbing again after switching to bouldering over two years ago, at the time I had just done my first 7A at Cheedale. When I look back on it I think I mainly muscled through it without really using any technique or strategy.&lt;/p&gt;

&lt;p&gt;During this current stint I have spent quite a bit of time reading about training and strategy and this has massively paid off. I have gone from flashing 6C to flashing over 8 7A&amp;#39;s and bringing my redpoint up to 7B+. I wanted to reflect on what made the difference to my climbing as I don&amp;#39;t think I am any stronger, I still climb about V6 or V7 on a good day so over the next few posts I am going to talk about some of the things I have learn / think I have learnt.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/post_images/beethoven.jpg&quot; alt=&quot;Leer of Beethoven&quot;&gt;
&lt;caption&gt;Working Leer of Beethoven - 7B+&lt;/caption&gt;&lt;/p&gt;

&lt;p&gt;The first post is going to go over how my training has changed over the past year. After my first few sport climbing trips it quickly became apparent that strength wasn&amp;#39;t a problem it was an inability to recover and my endurance through long easier sequences. Around this time I started reading &lt;a href=&quot;http://rockclimberstrainingmanual.com/&quot; target=&quot;_blank&quot;&gt;The Climbers Training Manual&lt;/a&gt; which was a great introduction to training the different attributes which make up a good climber (base fitness, strength, power and power endurance).&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/post_images/training_manual.jpg&quot; alt=&quot;Training Manual&quot;&gt;
&lt;caption&gt;Image from the Training manual site&lt;/caption&gt;&lt;/p&gt;

&lt;p&gt;The manual introduced me to structured training which is something I was missing for a long time, before this I would go to the climbing gym do some drills/exercies I had read about online and then probably see some gains but stop to early or over train and not see any further gains. With structured training you are following a programme which ensures you satisfy each of the spinning plates mentioned above. The image above shows how indepth the book goes into and by training in this structured way I have found you are optimising the time you spend training which means less time can achieve better results.&lt;/p&gt;

&lt;p&gt;The first phase of the programme is low intensity mileage, which for me meant spending 40 minutes at a time on the Autobelay. I used this time to focus on technique, ensuring every foot placement was good but also practicing resting techniques, during this time I learnt to hang off my forearms which later become a essential when recovering on crimpy crux sections as you can completely rest your fingers.&lt;/p&gt;

&lt;p&gt;In March I got the chance to climb in Siurana, while there we all started keeping a diary of the routes we had done as we were sharing one guide book between six people. After the trip I carried this on for all my climbing/training sessions which I think gives some retrospection on what worked well and also why you had a bad session e.g. you skipped lunch. Keeping a diary is pretty common with climbers, &lt;a href=&quot;http://www.moonclimbing.com/blog/2012/05/ben-moons-climbing-diary/&quot; target=&quot;_blank&quot;&gt;Ben Moon&lt;/a&gt; recently started posting entries from around the time he climbed the first 9A.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/post_images/siurana.jpg&quot; alt=&quot;Climbing in Siurana&quot;&gt;
&lt;caption&gt;The best crag in the world? Siuranella Centre, Siurana.&lt;/caption&gt;&lt;/p&gt;

&lt;p&gt;The training manual also recommends grade triangles which I have seen in a few other articles, I think using this as a boardgame where if you haven&amp;#39;t climbed a 7A+ sieging a 7B+ for months is a waste of time(trust me I have tried) as you will learn a lot by climbing each of those 7A&amp;#39;s.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;                                  7C
                               7B/+ 7B/+
                              7A+ 7A+ 7A+
                            7A 7A 7A 7A 7A 7A
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;My current triangle looks like this, before I made it I spent quite a lot of time working 7B+&amp;#39;s which were at my limit and this meant I was not getting any short term gratification or improving my technique. Fast forward 8 months and spending my time on those easier routes has paid off as I have climbed two 7B+ each in a session.&lt;/p&gt;

&lt;h2&gt;In summary&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;Look at structured training, these two sites are great - &lt;a href=&quot;http://rockclimberstrainingmanual.com/&quot; target=&quot;_blank&quot;&gt;The Climbers Training Manual&lt;/a&gt; and &lt;a href=&quot;http://www.stevemaischtraining.com&quot; target=&quot;_blank&quot;&gt;Steve Maisch Training&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;Keep a training diary.&lt;/li&gt;
&lt;li&gt;Set long and short term goals, put them on the wall so you can see it everyday.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Hopefully some of these notes help someone improve their climbing!&lt;/p&gt;

&lt;p&gt;Alex&lt;/p&gt;
</description>
        <pubDate>Fri, 31 Jul 2015 10:38:00 +0100</pubDate>
        <link>/one-year-as-a-sport-climber_part1/</link>
        <guid isPermaLink="true">/one-year-as-a-sport-climber_part1/</guid>
      </item>
    
      <item>
        <title>One year as a Sport Climber</title>
        <description>&lt;p&gt;For the past year I have been mainly sport climbing in the process of making this shift I have started to notice I have started to get over the plateau I was in.&lt;/p&gt;

&lt;p&gt;I thought I would try and sum up some of the things that have made a difference.&lt;/p&gt;

&lt;h2&gt;Diet and weight&lt;/h2&gt;

&lt;p&gt;I have always eaten what I wanted apart from the once or twice when I haven&amp;#39;t eaten meat or drunk for a month. This has never been a problem as I naturally eat an OK diet rarely eating fast food or packet meals but at the same time I rarely eat fish and most of my meals were beef/chicken with spinach!&lt;/p&gt;

&lt;p&gt;To try and improve this I have trying to introduce things like smoke salmon and go to an actual greengrocers to buy something other then spinach. This has been made easier since I moved in with my girlfriend who wasn&amp;#39;t a fan of the steak and spinach diet!&lt;/p&gt;

&lt;p&gt;Trying to eat healthy every week is hard so as a good starter just trying to eat well the week before you go away this is also pretty well researched. At the same time not drinking and getting a good weeks worth of sleep massively helps with fatigue.&lt;/p&gt;

&lt;p&gt;This year I have also changed what would be in my crag lunchbox, switching the Jamaca cake and bagels for lighter snacks like rice cakes and crackers so I can eat more regularly. This means you can climb all day without a big rest in the middle of the day to eat and digest the big meal you ate. One of my favourites is a Ryvita and some peanut butter between routes.&lt;/p&gt;

&lt;p&gt;I actually haven&amp;#39;t mentioned weight but if you do all of this you shouldn&amp;#39;t need to bother dieting!&lt;/p&gt;

&lt;iframe src=&quot;https://player.vimeo.com/video/129483531&quot; width=&quot;700&quot; height=&quot;400&quot; frameborder=&quot;0&quot; webkitallowfullscreen mozallowfullscreen allowfullscreen&gt;&lt;/iframe&gt;

&lt;p&gt;A funny video from Siurana to break up my ramblings.&lt;/p&gt;

&lt;h2&gt;Yoga and Flexibility&lt;/h2&gt;

&lt;p&gt;My hamstrings have been the cause of over 50% of my injury in climbing and running. My hamstrings are incredibly tight because for years I didn&amp;#39;t properly warm down after exercise this and to top it off I cycle to work and then sit at a desk for around 8 hours a day.&lt;/p&gt;

&lt;p&gt;Trying to solve this is hard because the gains are ridiculously gradual and I doubt I will be touching my toes any time soon.
My current strategy is trying to do yoga every morning in reality this equates to 4/5 days a week, after climbing I try to spend at least 10 minutes warming down. At work I have been trialling using a standing desk which works well with the &lt;a href=&quot;http://pomodorotechnique.com/&quot;&gt;Promadoro Method&lt;/a&gt; of working 25 minutes at a time and then sitting down during you&amp;#39;re break.&lt;/p&gt;

&lt;iframe width=&quot;700&quot; height=&quot;400&quot; src=&quot;https://www.youtube.com/embed/p27vpEU962w&quot; frameborder=&quot;0&quot; allowfullscreen&gt;&lt;/iframe&gt;

&lt;p&gt;This is the sequence I try and follow every morning.&lt;/p&gt;

&lt;h2&gt;The Right Conditions&lt;/h2&gt;

&lt;p&gt;Realising that trying to climb my hardest in full sunshine was a bad idea took me a surprising amount of time considering how much time I spent chasing the best conditions when I bouldered most of the time. Planning where to climb first based on which side of the crag gets the sun first is so important as it means you probably won&amp;#39;t need to chalk as much and the holds will probably be alot less sweaty.&lt;/p&gt;

&lt;p&gt;Conditions come second to the head game which I have suffered massively with, the conditions could be perfect but if you&amp;#39;re climbing clip to clip, constantly thinking about making it to safety at the next clip then there is no way you are going to be ticking anything at you&amp;#39;re actual limit! Instead you should be breaking the route up based on the boulder problems or sections that make up the routes and not the protection.
I find that if you are tired or have other things on you&amp;#39;re mind the game is pretty much over and you start to focus on making it to that next clip. Another thing that can ruin your headgame is not trusting your belayer.&lt;/p&gt;

&lt;iframe src=&quot;https://player.vimeo.com/video/109962062&quot; width=&quot;700&quot; height=&quot;400&quot; frameborder=&quot;0&quot; webkitallowfullscreen mozallowfullscreen allowfullscreen&gt;&lt;/iframe&gt;

&lt;h2&gt;Training&lt;/h2&gt;

&lt;p&gt;After my first few sport climbing trip it quickly became apparent that strength wasn&amp;#39;t a problem it was inability to recover and my endurance through long easier sequences. Around this time I started reading &lt;a href=&quot;http://rockclimberstrainingmanual.com/&quot;&gt;The Climbers Training Manual&lt;/a&gt; which was a great introduction to ensuring you are training each of the different attributes of climbing (base fitness, strength, power and power endurance). This book got me into structured training as well as writing notes about how the session or trip, went this retrospection helps you take some time to think what worked well and also why you had a bad session e.g. you skipped lunch.&lt;/p&gt;

&lt;p&gt;The training manual also recommends grade triangles which I have seen in a few other articles, I think using this as a boardgame type thing where if you haven&amp;#39;t climbed a 7A+ sieging a 7B+ for months is a waste of time as you will learn a lot by climbing each of those routes.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;                                  7C
                               7B/+ 7B/+
                              7A+ 7A+ 7A+
                            7A 7A 7A 7A 7A 7A
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;My current triangle looks like this bofore I made it I spent quite a lot of time working 7B+&amp;#39;s which were at my limit and this meant I was not getting any short term gratification or improving my technique for resting for example.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/post_images/beethoven.jpg&quot; alt=&quot;Leer of Beethoven&quot;&gt;&lt;/p&gt;

&lt;p&gt;Working Leer of Beethoven - 7B+&lt;/p&gt;

&lt;p&gt;Hopefully some of these notes help someone improve their climbing!&lt;/p&gt;

&lt;p&gt;Alex&lt;/p&gt;
</description>
        <pubDate>Mon, 08 Jun 2015 10:38:00 +0100</pubDate>
        <link>/one-year-as-a-sport-climber/</link>
        <guid isPermaLink="true">/one-year-as-a-sport-climber/</guid>
      </item>
    
      <item>
        <title>The bloated Ruby block</title>
        <description>&lt;p&gt;I am currently spending a month climbing in Spain before I start looking for a new job and in
the process decided to setup up my old MacBook Pro for the journey.
While I was moving my files over I found a draft of this blog post.&lt;/p&gt;

&lt;p&gt;I remember blocks being confusing when I first started learning Ruby, they seemed alien when compared to my PHP code.
After a while I got the hang of them and soon my code was littered with these nuggets:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;no&quot;&gt;Rack&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Rewrite&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;r301&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;/wiki/alex&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;/alex&amp;quot;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;rewrite&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;/docs/go&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;/documentation/go&amp;quot;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;After a while they started looking like some of my university coursework, lots of code which was hard to read and make changes too.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;no&quot;&gt;Rack&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Rewrite&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;r301&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;/wiki/alex&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;/alex&amp;quot;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;r301&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;/wiki/steve&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;/steve&amp;quot;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;r301&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;/wiki/billy&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;/billy&amp;quot;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;r301&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;/wiki/jake&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;/jake&amp;quot;&lt;/span&gt;

  &lt;span class=&quot;n&quot;&gt;rewrite&lt;/span&gt; &lt;span class=&quot;sr&quot;&gt;%r{(.*)}&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;lambda&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;match&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rack_env&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;match&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;/docs/hipster-js&amp;quot;&lt;/span&gt;
      &lt;span class=&quot;s2&quot;&gt;&amp;quot;https://www.destroyallsoftware.com/talks/wat&amp;quot;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;match&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

   &lt;span class=&quot;c1&quot;&gt;# This would go on and on...&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;One way to improve this is to pull out the logic into functions which helps to give context to the code.
i.e what is happening in each part, this is helpful for someone reading the code for the first time.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;no&quot;&gt;Rack&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Rewrite&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;# The &amp;quot;*&amp;quot; symbol simply flattens the array into the&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;# separate parameters the method expects.&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;wiki_permanant_redirects&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;each&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r301&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;args&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;n&quot;&gt;rewrite&lt;/span&gt; &lt;span class=&quot;sr&quot;&gt;%r{(.*)}&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;redirect_hipster_js_to_wat_talk&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;redirect_hipster_js_to_wat_talk&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;lambda&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;match&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rack_env&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;match&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;/docs/hipster-js&amp;quot;&lt;/span&gt;
      &lt;span class=&quot;s2&quot;&gt;&amp;quot;https://www.destroyallsoftware.com/talks/wat&amp;quot;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;match&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;wiki_permanant_redirects&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;wiki_users&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;alex&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;steve&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;billy&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;jake&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;

  &lt;span class=&quot;n&quot;&gt;wiki_users&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;collect&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;user&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;/wiki/&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;user&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;/&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;user&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;The functions could be implemented as classes which will enable you to test in isolation.&lt;/p&gt;

&lt;p&gt;Another solution using a loop is to collect the parts of the block as Lambda&amp;#39;s and then pass them to the block.
This solution works well when there are lots of pieces of logic such as partial Tire queries when using ElasticSearch.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;n&quot;&gt;tags&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;ruby&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;java&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;python&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;partial_queries&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tags&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;collect&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tag&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;lambda&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;boolean&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;tags:&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tag&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;no&quot;&gt;Tire&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;search&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;articles&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;query&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;partial_queries&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;each&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;partial_query&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;partial_query&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;** I am not able to test the above code as the Internet here isn&amp;#39;t good enough to download ElasticSearch.&lt;/p&gt;

&lt;p&gt;I like this way of structuring blocks when I know it is going to grow quickly. e.g. when building a complex search.&lt;/p&gt;

&lt;p&gt;Because you can continue to grow out the number of query parameters and isolate complex logic to enable easy testing.
As with the first example, classes can be used to group similar logic such as tags and word searches within articles in this example.&lt;/p&gt;

&lt;p&gt;At the same time if the search is basic this would be massively overkill and would make the code hard to read.&lt;/p&gt;

&lt;p&gt;Hope this helps someone with a bloated block problem :)&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/post_images/blocks_office.png&quot; alt=&quot;View from Siurana Campsite&quot;&gt;&lt;/p&gt;

&lt;p&gt;My office view.&lt;/p&gt;
</description>
        <pubDate>Wed, 01 Apr 2015 10:38:00 +0100</pubDate>
        <link>/ruby-blocks/</link>
        <guid isPermaLink="true">/ruby-blocks/</guid>
      </item>
    
      <item>
        <title>Rails Dependent Associations</title>
        <description>&lt;p&gt;I often find that the dependent parameter gets forgotten on projects. This is easy to do if you&amp;#39;re new to Rails. When dependent is not set, nothing terrible happens at firstâ€¦ but once you get further into a project you will start seeing this:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;2.1.2 :013 &amp;gt; Comment.first.post.title
  Comment Load &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.6ms&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;  SELECT  &lt;span class=&quot;s2&quot;&gt;&amp;quot;comments&amp;quot;&lt;/span&gt;.* FROM &lt;span class=&quot;s2&quot;&gt;&amp;quot;comments&amp;quot;&lt;/span&gt;   ORDER BY &lt;span class=&quot;s2&quot;&gt;&amp;quot;comments&amp;quot;&lt;/span&gt;.&lt;span class=&quot;s2&quot;&gt;&amp;quot;id&amp;quot;&lt;/span&gt; ASC LIMIT 1
  Post Load &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.3ms&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;  SELECT  &lt;span class=&quot;s2&quot;&gt;&amp;quot;posts&amp;quot;&lt;/span&gt;.* FROM &lt;span class=&quot;s2&quot;&gt;&amp;quot;posts&amp;quot;&lt;/span&gt;  WHERE &lt;span class=&quot;s2&quot;&gt;&amp;quot;posts&amp;quot;&lt;/span&gt;.&lt;span class=&quot;s2&quot;&gt;&amp;quot;id&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$1&lt;/span&gt; LIMIT &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;id&amp;quot;&lt;/span&gt;, 1&lt;span class=&quot;o&quot;&gt;]]&lt;/span&gt;
  NoMethodError: undefined method &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;title&lt;span class=&quot;err&quot;&gt;&amp;#39;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; nil:NilClass&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;The cause of the error is that the parent record no longer exists, but the foreign key still references the parent object.
To stop this from happening you can use the dependent option with &lt;code&gt;has_many&lt;/code&gt; and &lt;code&gt;has_one&lt;/code&gt;.&lt;/p&gt;

&lt;h1&gt;Dependent Options&lt;/h1&gt;

&lt;p&gt;Dependent simply tells destroy what to do with child records. The available dependent options are as follows:&lt;/p&gt;

&lt;h2&gt;Destroy&lt;/h2&gt;

&lt;p&gt;The destroy option is the most common in a Rails app, as it is the most likely scenario. For example, when you delete a post, you probably want to remove the comments as well.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Post&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;ActiveRecord&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Base&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;has_many&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:comments&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;dependent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:destroy&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Comment&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;ActiveRecord&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Base&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;belongs_to&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:post&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;after_destroy&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;puts&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;Callback Fired&amp;quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now when you delete the post the comments are also deleted. Any callback&amp;#39;s that are defined will also be fired.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;2.1.2 :004 &amp;gt; p.destroy
   &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.1ms&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;  BEGIN
  Comment Load &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.3ms&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;  SELECT &lt;span class=&quot;s2&quot;&gt;&amp;quot;comments&amp;quot;&lt;/span&gt;.* FROM &lt;span class=&quot;s2&quot;&gt;&amp;quot;comments&amp;quot;&lt;/span&gt;  WHERE &lt;span class=&quot;s2&quot;&gt;&amp;quot;comments&amp;quot;&lt;/span&gt;.&lt;span class=&quot;s2&quot;&gt;&amp;quot;post_id&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$1&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;post_id&amp;quot;&lt;/span&gt;, 18&lt;span class=&quot;o&quot;&gt;]]&lt;/span&gt;
  SQL &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.2ms&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;  DELETE FROM &lt;span class=&quot;s2&quot;&gt;&amp;quot;comments&amp;quot;&lt;/span&gt; WHERE &lt;span class=&quot;s2&quot;&gt;&amp;quot;comments&amp;quot;&lt;/span&gt;.&lt;span class=&quot;s2&quot;&gt;&amp;quot;id&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$1&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;id&amp;quot;&lt;/span&gt;, 26&lt;span class=&quot;o&quot;&gt;]]&lt;/span&gt;
Callback Fired
  SQL &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.2ms&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;  DELETE FROM &lt;span class=&quot;s2&quot;&gt;&amp;quot;comments&amp;quot;&lt;/span&gt; WHERE &lt;span class=&quot;s2&quot;&gt;&amp;quot;comments&amp;quot;&lt;/span&gt;.&lt;span class=&quot;s2&quot;&gt;&amp;quot;id&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$1&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;id&amp;quot;&lt;/span&gt;, 27&lt;span class=&quot;o&quot;&gt;]]&lt;/span&gt;
Callback Fired
  SQL &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.2ms&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;  DELETE FROM &lt;span class=&quot;s2&quot;&gt;&amp;quot;posts&amp;quot;&lt;/span&gt; WHERE &lt;span class=&quot;s2&quot;&gt;&amp;quot;posts&amp;quot;&lt;/span&gt;.&lt;span class=&quot;s2&quot;&gt;&amp;quot;id&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$1&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;id&amp;quot;&lt;/span&gt;, 18&lt;span class=&quot;o&quot;&gt;]]&lt;/span&gt;
   &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1.6ms&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;nv&quot;&gt;COMMIT&lt;/span&gt;
 &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;gt; &lt;span class=&quot;c&quot;&gt;#&amp;lt;Post id: 18, title: &amp;quot;Post 101&amp;quot;, body: nil, created_at: &amp;quot;2015-02-07 16:42:13&amp;quot;, updated_at: &amp;quot;2015-02-07 16:42:13&amp;quot;&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;The destroy option should be a default in Rails because of the ethos of convention over configuration. Currently what happens is the child record doesn&amp;#39;t have its foreign key nullified, which is the next option we will look at.&lt;/p&gt;

&lt;p&gt;I don&amp;#39;t think we could change this default now as it would cause unexpected behaviors when updating to a new Rails version.&lt;/p&gt;

&lt;h2&gt;Nullify&lt;/h2&gt;

&lt;p&gt;Nullify is the opposite to destroy, it means the child record is not destroyed after Active Record removes the parent. Curiously, not that many developers seem to know that this option exist.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Post&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;ActiveRecord&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Base&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;has_many&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:comments&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;dependent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:nullify&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now when you delete the post the comment is not deleted. Instead the foreign key is set to Null.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;.1.2 :003 &amp;gt; p.destroy
  &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.2ms&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;  BEGIN
 Comment Load &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.5ms&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;  SELECT &lt;span class=&quot;s2&quot;&gt;&amp;quot;comments&amp;quot;&lt;/span&gt;.* FROM &lt;span class=&quot;s2&quot;&gt;&amp;quot;comments&amp;quot;&lt;/span&gt;  WHERE &lt;span class=&quot;s2&quot;&gt;&amp;quot;comments&amp;quot;&lt;/span&gt;.&lt;span class=&quot;s2&quot;&gt;&amp;quot;post_id&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$1&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;post_id&amp;quot;&lt;/span&gt;, 3&lt;span class=&quot;o&quot;&gt;]]&lt;/span&gt;
 SQL &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.3ms&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;  DELETE FROM &lt;span class=&quot;s2&quot;&gt;&amp;quot;comments&amp;quot;&lt;/span&gt; WHERE &lt;span class=&quot;s2&quot;&gt;&amp;quot;comments&amp;quot;&lt;/span&gt;.&lt;span class=&quot;s2&quot;&gt;&amp;quot;id&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$1&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;id&amp;quot;&lt;/span&gt;, 3&lt;span class=&quot;o&quot;&gt;]]&lt;/span&gt;
 SQL &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.2ms&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;  DELETE FROM &lt;span class=&quot;s2&quot;&gt;&amp;quot;posts&amp;quot;&lt;/span&gt; WHERE &lt;span class=&quot;s2&quot;&gt;&amp;quot;posts&amp;quot;&lt;/span&gt;.&lt;span class=&quot;s2&quot;&gt;&amp;quot;id&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$1&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;id&amp;quot;&lt;/span&gt;, 3&lt;span class=&quot;o&quot;&gt;]]&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1.7ms&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;nv&quot;&gt;COMMIT&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;gt; &lt;span class=&quot;c&quot;&gt;#&amp;lt;Post id: 3, title: &amp;quot;Post 101&amp;quot;, body: nil, created_at: &amp;quot;2015-01-31 13:01:43&amp;quot;, updated_at: &amp;quot;2015-01-31 13:01:43&amp;quot;&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;This is better than leaving the foreign key set but will still cause an error if you try to access the post.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;2.1.2 :006 &amp;gt; Comment.find&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;4&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.post.title
  Comment Load &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.5ms&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;  SELECT  &lt;span class=&quot;s2&quot;&gt;&amp;quot;comments&amp;quot;&lt;/span&gt;.* FROM &lt;span class=&quot;s2&quot;&gt;&amp;quot;comments&amp;quot;&lt;/span&gt;  WHERE &lt;span class=&quot;s2&quot;&gt;&amp;quot;comments&amp;quot;&lt;/span&gt;.&lt;span class=&quot;s2&quot;&gt;&amp;quot;id&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$1&lt;/span&gt; LIMIT &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;id&amp;quot;&lt;/span&gt;, 4&lt;span class=&quot;o&quot;&gt;]]&lt;/span&gt;
NoMethodError: undefined method &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;title&lt;span class=&quot;err&quot;&gt;&amp;#39;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; nil:NilClass&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2&gt;Delete All&lt;/h2&gt;

&lt;p&gt;The delete all option is the same as destroy but no callbacks will be executed.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Comment&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;ActiveRecord&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Base&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;belongs_to&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:post&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;after_destroy&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;puts&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;Callback Fired&amp;quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Post&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;ActiveRecord&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Base&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;has_many&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:comments&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;dependent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:delete_all&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;2.1.2 :011 &amp;gt; p.destroy
   &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.2ms&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;  BEGIN
  SQL &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.3ms&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;  DELETE FROM &lt;span class=&quot;s2&quot;&gt;&amp;quot;comments&amp;quot;&lt;/span&gt; WHERE &lt;span class=&quot;s2&quot;&gt;&amp;quot;comments&amp;quot;&lt;/span&gt;.&lt;span class=&quot;s2&quot;&gt;&amp;quot;post_id&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$1&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;post_id&amp;quot;&lt;/span&gt;, 11&lt;span class=&quot;o&quot;&gt;]]&lt;/span&gt;
  SQL &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.3ms&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;  DELETE FROM &lt;span class=&quot;s2&quot;&gt;&amp;quot;posts&amp;quot;&lt;/span&gt; WHERE &lt;span class=&quot;s2&quot;&gt;&amp;quot;posts&amp;quot;&lt;/span&gt;.&lt;span class=&quot;s2&quot;&gt;&amp;quot;id&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$1&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;id&amp;quot;&lt;/span&gt;, 11&lt;span class=&quot;o&quot;&gt;]]&lt;/span&gt;
   &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1.4ms&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;nv&quot;&gt;COMMIT&lt;/span&gt;
 &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;gt; &lt;span class=&quot;c&quot;&gt;#&amp;lt;Post id: 11, title: &amp;quot;Post 101&amp;quot;, body: nil, created_at: &amp;quot;2015-02-04 08:48:18&amp;quot;, updated_at: &amp;quot;2015-02-04 08:48:18&amp;quot;&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2&gt;Restrict with Exception&lt;/h2&gt;

&lt;p&gt;This is an option that I have to admit Iâ€™ve never seen or used before writing this article. Restrict with exception raises an exception when destroy is called on a parent record with children. The parent will only be deleted if the parent doesn&amp;#39;t have associated children.&lt;/p&gt;

&lt;p&gt;I can imagine it to be useful if you wanted to protect against posts with comments being deleted.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Post&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;ActiveRecord&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Base&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;has_many&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:comments&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;dependent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:restrict_with_exception&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;2.1.2 :003 &amp;gt; p.destroy
   &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.2ms&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;  BEGIN
   &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;2.3ms&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;  ROLLBACK
ActiveRecord::DeleteRestrictionError: Cannot delete record because of dependent comments&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;As you can see this raises an ActiveRecord::DeleteRestrictionError exception if a comment exists.&lt;/p&gt;

&lt;h2&gt;Restrict with Error&lt;/h2&gt;

&lt;p&gt;The last option is restrict with error which sets an error on the parent record if the parent has child records associated.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Post&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;ActiveRecord&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Base&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;has_many&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:comments&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;dependent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:restrict_with_error&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;2.1.2 :003 &amp;gt; p.destroy
   &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.2ms&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;  BEGIN
   &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.2ms&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;nv&quot;&gt;ROLLBACK&lt;/span&gt;
 &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;gt; &lt;span class=&quot;nb&quot;&gt;false&lt;/span&gt;
2.1.2 :004 &amp;gt; p.errors
 &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;gt; &lt;span class=&quot;c&quot;&gt;#&amp;lt;ActiveModel::Errors:0x000001016a9828 @base=#&amp;lt;Post id: 6, title: &amp;quot;Post 101&amp;quot;, body: nil, created_at: &amp;quot;2015-01-31 13:19:36&amp;quot;, updated_at: &amp;quot;2015-01-31 13:19:36&amp;quot;&amp;gt;, @messages={:base=&amp;gt;[&amp;quot;Cannot delete record because dependent comments exist&amp;quot;]}&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Active Record has added an error to the errors attribute in the same way as a validation error would be added.
I think this would work well with validations as you can  display this error to the admin trying to delete the post.
Restrict with error could be a replacement to doing a custom validation rule in less code. The downside you would lose the if/unless functionality available in validation.&lt;/p&gt;

&lt;p&gt;I know that the dependent parameter is not the most exciting thing to read about but knowing the less known features in a framework can save you time when working on your next amazing feature.&lt;/p&gt;

&lt;p&gt;Alex&lt;/p&gt;
</description>
        <pubDate>Sat, 31 Jan 2015 09:38:00 +0000</pubDate>
        <link>/rails-dependent-associations/</link>
        <guid isPermaLink="true">/rails-dependent-associations/</guid>
      </item>
    
      <item>
        <title>Dumbfounded</title>
        <description>&lt;p&gt;A few weeks ago before the temperature got turned up I spent the bank holiday sport climbing in Dorset. I spotted this blank looking face and thought it looked amazing. Dumbfounded - 7b+&lt;/p&gt;

&lt;iframe frameborder=&quot;0&quot; height=&quot;281&quot; src=&quot;//player.vimeo.com/video/95857428&quot; width=&quot;700&quot;&gt;&lt;/iframe&gt;
</description>
        <pubDate>Mon, 26 May 2014 10:38:00 +0100</pubDate>
        <link>/dumbfounded/</link>
        <guid isPermaLink="true">/dumbfounded/</guid>
      </item>
    
      <item>
        <title>Protip: Pasting code in Vim (Updated)</title>
        <description>&lt;p&gt;On &lt;a href=&quot;http://rubyrogues.com/129-rr-sharpening-tools-with-ben-orenstein/&quot; target=&quot;_blank&quot;&gt;Ruby Rogues&lt;/a&gt; a few weeks back, Ben Orenstein mentioned he tries to spend 15 minutes a day improving his workflow and tools. I decided to take this onboard and this week I looked into how to paste code in Vim without loosing its indentation.&lt;/p&gt;
&lt;p&gt;1. Turn off autoindent.&lt;/p&gt;
&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-vim&quot; data-lang=&quot;vim&quot;&gt;  :&lt;span class=&quot;k&quot;&gt;set&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;paste&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;2. Enter insert mode.&lt;/p&gt;
&lt;p&gt;3. Paste code&lt;/p&gt;
&lt;p&gt;4. Turn autoindent back on.&lt;/p&gt;
&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-vim&quot; data-lang=&quot;vim&quot;&gt;  :&lt;span class=&quot;k&quot;&gt;set&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;nopaste&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
&lt;p&gt;I found the solution &lt;a href=&quot;http://stackoverflow.com/questions/2514445/turning-off-auto-indent-when-pasting-text-into-vim/2514520#2514520&quot; target=&quot;_blank&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Enjoy&lt;br/&gt;Alex&lt;/p&gt;
</description>
        <pubDate>Sun, 09 Feb 2014 16:22:00 +0000</pubDate>
        <link>/protip-pasting-code-in-vim/</link>
        <guid isPermaLink="true">/protip-pasting-code-in-vim/</guid>
      </item>
    
  </channel>
</rss>